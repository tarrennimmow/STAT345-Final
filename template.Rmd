---
title: "Super Awesome Project Template"
output: word_document
date: "2023-03-31"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tibble)
library(tidyr)
library(utils)
library(dplyr)
library(googleway)
library(httr)
library(magrittr)
```

## Section One

```{r student1}
#Noah Viegut's section

Gameboard <- data.frame(space = 1:40, title = c("Go", "Mediterranean Avenue", "Community Chest", "Baltic Avenue", "Income Tax", "Reading Railroad", "Oriental Avenue", "Chance", "Vermont Avenue", "Connecticut Avenue", "Jail / Just Visiting", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Community Chest", "Tennessee Avenue", "New York Avenue", "Free Parking", "Kentucky Avenue", "Chance", "Indiana Avenue", "Illinois Avenue", "B. & O. Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Go To Jail", "Pacific Avenue", "North Carolina Avenue", "Community Chest", "Pennsylvania Avenue", "Short Line", "Chance", "Park Place", "Luxury Tax", "Boardwalk"))



ChanceCards <- data.frame(index = 1:16, card = c("Advance to Boardwalk", "Advance to Go (Collect $200)", "Advance to Illinois Avenue. If you pass Go, collect $200", "Advance to St. Charles Place. If you pass Go, collect $200", "Advance to the nearest Railroad. If unowned, you may buy it from the Bank. If owned, pay wonder twice the rental to which they are otherwise entitled", "Advance to the nearest Railroad. If unowned, you may buy it from the Bank. If owned, pay wonder twice the rental to which they are otherwise entitled", "Advance token to nearest Utility. If unowned, you may buy it from the Bank. If owned, throw dice and pay owner a total ten times amount thrown.", "Bank pays you dividend of $50", "Get Out of Jail Free", "Go Back 3 Spaces", "Go to Jail. Go directly to Jail, do not pass Go, do not collect $200", "Make general repairs on all your property. For each house pay $25. For each hotel pay $100", "Speeding fine $15", "Take a trip to Reading Railroad. If you pass Go, collect $200", "You have been elected Chairman of the Board. Pay each player $50", "Your building loan matures. Collect $150"))

#ChanceMove <- data.frame(index = 1:16, moveto = c())


CommunityChestCards <- data.frame(index = 1:16, card = c("Advance to Go (Collect $200)", "Bank error in your favor. Collect $200", "Doctorâ€™s fee. Pay $50", "From sale of stock you get $50", "Get Out of Jail Free", "Go to Jail. Go directly to jail, do not pass Go, do not collect $200", "Holiday fund matures. Receive $100", "Income tax refund. Collect $20", "It is your birthday. Collect $10 from every player", "Life insurance matures. Collect $100", "Pay hospital fees of $100", "Pay school fees of $50", "Receive $25 consultancy fee", "You are assessed for street repair. $40 per house. $115 per hotel", "You have won second prize in a beauty contest. Collect $10", "You inherit $100"))

#<<<<<<< HEAD
#CommunityChestMove <- data.frame(index = 1:16, moveto = c())

player <- setRefClass("player", fields = list(pos="numeric", verbos='logical'), method=list(
  move = function(x){},
  go2 = function(x){},
  stuck = function(x){},
  getout = function(x){},
  go2jail = function(x){}
))

#=======
#CommunityMove <- data.frame(index = 1:16, moveto = c())
#>>>>>>> 5c4c8c539ce83b870ff323c5512c6abf74720eaa

```


## Section Two

```{r student2}
#Tarren
# another test
```

## Section Three

```{r student3}
#James Bartsch
#dice with unique doubles/triples results
roll<-function() {
  die <- sample(1:6, 6, replace = T)
  if(die[1] != die[2]){
    total_sum<<-sum(die[1:2])
    return(total_sum)
  }
  if( die[3] != die[4]){
    print("double")
  total_sum<<-sum(die[1:4])
    return(total_sum)}
if(die[5] != die[6]){
  total_sum<<-0
    print("triple")
  print("go to jail")
}}

tiles <- c("Go", "Mediterranean Avenue", "Community Chest", "Baltic Avenue", "Income Tax", 
           "Reading Railroad", "Oriental Avenue", "Chance", "Vermont Avenue", "Connecticut Avenue", 
           "Jail", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", 
           "Pennsylvania Railroad", "St. James Place", "Community Chest", "Tennessee Avenue", 
           "New York Avenue", "Free Parking", "Kentucky Avenue", "Chance", "Indiana Avenue", 
           "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", 
           "Marvin Gardens", "Go to Jail", "Pacific Avenue", "North Carolina Avenue", "Community Chest", 
           "Pennsylvania Avenue", "Short Line Railroad", "Chance", "Park Place", "Luxury Tax", "Boardwalk")


board_squares<- tibble("Tile Name" = tiles, Class = NA, Occupants = NA, Owner = NA, "Part of Monopoly" = NA, Description = NA, "Cost to Occupy" = NA, Effect = NA, "Effect on Player 1" = NA,"Effect on Player 2" = NA,"Effect on Player 3" = NA,"Effect on Player 4" = NA)

reset_board<-function(){#takes in no input and outputs a reset game board
  
  #sets game board to NULL
  new_board_squares<-NULL 
  
#defines the tiles in order
tiles <- c("Go", "Mediterranean Avenue", "Community Chest", "Baltic Avenue", "Income Tax", 
           "Reading Railroad", "Oriental Avenue", "Chance", "Vermont Avenue", "Connecticut Avenue", 
           "Jail", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", 
           "Pennsylvania Railroad", "St. James Place", "Community Chest", "Tennessee Avenue", 
           "New York Avenue", "Free Parking", "Kentucky Avenue", "Chance", "Indiana Avenue", 
           "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", 
           "Marvin Gardens", "Go to Jail", "Pacific Avenue", "North Carolina Avenue", "Community Chest", 
           "Pennsylvania Avenue", "Short Line Railroad", "Chance", "Park Place", "Luxury Tax", "Boardwalk")

#defines potential variables each tile can have in the form of a spread sheet
board_squares<- tibble("Tile Name" = tiles, Class = NA, Occupants = NA, Owner = NA, "Part of Monopoly" = NA, Description = NA, "Cost to Occupy" = NA, Effect = NA, "Effect on Player_1" = NA,"Effect on Player_2" = NA,"Effect on Player_3" = NA,"Effect on Player_4" = NA, "Effect on Bank"= NA)

#defines the property tiles as Class = "Property Tile" in the spread sheet
Property_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Mediterranean Avenue", "Baltic Avenue", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "States Avenue", "Virginia Avenue", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "Atlantic Avenue", "Ventnor Avenue", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Park Place", "Boardwalk"))%>%
  mutate(`Class` = "Property Tile")

#defines the utility tiles as Class = "Utility Tile" in the spread sheet
Utility_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Electric Company", "Water Works"))%>%
  mutate(`Class` = "Utility Tile")

#defines the Railroad tiles as Class = "Railroad Tile" in the spread sheet
Railroad_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Reading Railroad", "Pennsylvania Railroad", "B&O Railroad", "Short Line Railroad"))%>%
  mutate(`Class` = "Railroad Tile")
#etc...
Chance_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Chance"))%>%
  mutate(`Class` = "Chance Tile")

Community_Chest_Tiles<-board_squares %>% filter(`Tile Name` %in% c("Community Chest"))%>%
  mutate(`Class` = "Community Chest")

Go_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Go", "Luxury Tax", "Income Tax", "Go to Jail"))%>%
  mutate(`Class` = "Go Tile")

Luxury_Tax_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Luxury Tax", "Income Tax", "Go to Jail"))%>%
  mutate(`Class` = "Luxury Tax")

Income_Tax_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Income Tax"))%>%
  mutate(`Class` = "Income Tax")

Go_to_Jail_Tiles<- board_squares %>% filter(`Tile Name` %in% c("Go to Jail"))%>%
  mutate(`Class` = "Go to Jail Tile")

Jail<- board_squares %>% filter(`Tile Name` %in% c("Jail"))%>%
  mutate(`Class` = "Jail")

Free_Parking<- board_squares %>% filter(`Tile Name` %in% c("Free Parking"))%>%
  mutate(`Class` = "Free Parking")
new_board_squares<-bind_rows(Property_Tiles,Utility_Tiles,Railroad_Tiles,Chance_Tiles,Community_Chest_Tiles,Go_Tiles,Luxury_Tax_Tiles,Income_Tax_Tiles,Go_to_Jail_Tiles,Jail,Free_Parking)
new_board_squares<-new_board_squares[match(board_squares$`Tile Name`, new_board_squares$`Tile Name`), ]


#recombines the different tile classes together
new_board_squares<<-bind_rows(Property_Tiles,Utility_Tiles,Railroad_Tiles,Chance_Tiles,Community_Chest_Tiles,Go_Tiles,Luxury_Tax_Tiles,Income_Tax_Tiles,Go_to_Jail_Tiles,Jail,Free_Parking)

#reorganizes the tiles back into their correct locations
new_board_squares<<-new_board_squares[match(board_squares$`Tile Name`, new_board_squares$`Tile Name`), ]
View(new_board_squares)
}



#need to add check counting how many "?" values are included in the token_selection






player_select <-function(...){
  token_selection<-function(...) {#takes a 2 to 4 values, either the name of a piece or a ?, and outputs those pieces as a character vector
  
as.character(c(...))
  
  #list of pieces
  pieces <- c("ace of spades","airplane","alarm clock","alligator","anvil","baby dinosaur","bag of money","balloon","baseball glove","basket","battleship","beach cruiser bike","bear","bicycle","boat","boot","bowtie","cactus","cannon","car","cat","cell phone","cheeseburger","chef's hat","chicken","computer","conductor's hat","cowboy hat","crab","crown","crystal","diamond","diamond ring","dice","dog","donut","dragon","duck","ducky","earmuffs","earth","egg","electric guitar","elephant","empanada","fire hydrant","fish","fishing pole","football","football helmet","frankenstein","french fries","frog","ghost","giant panda","gingerbread man","giraffe","globe","goldfish","golf bag","gondola","graduation cap","grapes","guitar","hammer","handcuffs","happy meal","hard hat","hashtag","hat","helicopter","hot air balloon","hot dog","horse and rider","horse shoe","ice cream cone","iron","jet plane","kangaroo","kettle","key","keyboard","king","kitty","koala","lantern","laptop","lighthouse","limousine","lion","little red wagon","locomotive","london bus","magic lamp","magnet","mallard duck","mallet","maple leaf","matchstick","metal car","microphone","money bag","monster truck","moon rover","motorcycle","mr. monopoly","music note","new balance sneaker","panda","penguin","phone","piece of cake","piggy bank","pineapple","plane","pretzel","pumpkin","racecar","razor","robot","roller skate","rooster","rubber ducky","sailboat","saxophone","scottie dog","shoe","skateboard","spaceship","spoon","sports car","stack of cash","star","statue of liberty","stethoscope","strawberry","sunflower","sunglasses","surfboard","taco","thimble","top hat","t-rex","tree","trolley car","trumpet","turtle","tv","typewriter","umbrella","wheelbarrow")
  
  #Changes everything to lower case in case input has different formatting
  names <- tolower(c(...))
  
  #Check that there are between 2 and 4 names
  if (length(names) < 2 || length(names) > 4) {
    message("Please input between 2 and 4 valid Monopoly piece names")
    return(NULL)
  }
  
  #Check that each name is a valid Monopoly piece or "?"
  valid_pieces <- c(pieces, "?")
  for (name in names) {
    if (!(name %in% valid_pieces)) {
      message("Invalid Monopoly piece name: ", name)
      return(NULL)
    }
  }
  
  # Assigns a random piece to any "?" inputs
  if ("?" %in% names) {
    chosen_pieces <- unique(names[names != "?"])
    available_pieces <- setdiff(pieces, chosen_pieces)
    random_pieces <- sample(available_pieces, length(names[names == "?"]), replace = F)
    names[names == "?"] <- random_pieces
  }
  
  # Creates a tibble of Player_Number and Name
  player_num <- 1:length(names)
  tibble(Player_Number = player_num, Name = names)
}

assign_player_stats <- function(...){
  
  # Combine the names into a vector
  names<-c(...)
  # Generate random scores for each player
  scores <- sample(1:6, length(names) * 2, replace = TRUE)
  scores <- tapply(scores, rep(1:length(names), each = 2), sum)
  
  # Combine the names and scores into a tibble
  player_stats <- tibble(Name = names, Score = scores)
  
  # Sort the tibble by score in descending order
  player_stats <- player_stats[order(-player_stats$Score), ]
  
  # Assign the player numbers
  player_stats$Player_Number <- 1:nrow(player_stats)
  
  # Return the tibble with only two columns
  return(na.omit(player_stats[1:4, c("Player_Number", "Name")]))
}
return(token_selection(c(...))$Name%>%assign_player_stats())#janky function gluing the other two into a single command
}


#set player locations to square 1
#steps for starting each new game

#######manual reset of the board game(will automate later)
#takes money from bank and gives it to the player_stats
player_stats<-player_select("?","?","?","?")#test with random names
reset_board()
player_stats <- player_stats %>%
  mutate(Money = NA_real_,Location = NA_character_,
         'Owned Properties' = NA_character_,'Houses' = 0,'Hotels' = 0)
bank<-tibble(Money = 15140,
         houses = 32, hotels = 12)
bank$Money<- bank$Money-1500*nrow(player_stats)
player_stats$Money<- 1500
player_stats$Location<-1
new_board_squares$Occupants[1] <-list(player_stats$Name)
new_board_squares$Occupants[[1]]
player_turn<-c(1)
total_turns<-c(1)
reset_CommunityChestCards()


#card effects(birthday card need to be worked on, get out of jail free needs to update a stat indicating that, birthday card needs to remove $10 from each other player as well,


reset_CommunityChestCards<-function(){
  removed_community_cards <<- data.frame(matrix(ncol = 0, nrow = 0))
  CommunityChestCards <- data.frame(card = c("Advance to Go (Collect $200)", "Bank error in your favor. Collect $200", "Doctorâ€™s fee. Pay $50", "From sale of stock you get $50", "Get Out of Jail Free", "Go to Jail. Go directly to jail, do not pass Go, do not collect $200", "Holiday fund matures. Receive $100", "Income tax refund. Collect $20", "It is your birthday. Collect $10 from every player", "Life insurance matures. Collect $100", "Pay hospital fees of $100", "Pay school fees of $50", "Receive $25 consultancy fee", "You are assessed for street repair. $40 per house. $115 per hotel", "You have won second prize in a beauty contest. Collect $10", "You inherit $100"))
CommunityChestCards <- data.frame(index = 1:16, card = c("Advance to Go (Collect $200)", "Bank error in your favor. Collect $200", "Doctorâ€™s fee. Pay $50", "From sale of stock you get $50", "Get Out of Jail Free", "Go to Jail. Go directly to jail, do not pass Go, do not collect $200", "Holiday fund matures. Receive $100", "Income tax refund. Collect $20", "It is your birthday. Collect $10 from every player", "Life insurance matures. Collect $100", "Pay hospital fees of $100", "Pay school fees of $50", "Receive $25 consultancy fee", "You are assessed for street repair. $40 per house. $115 per hotel", "You have won second prize in a beauty contest. Collect $10", "You inherit $100"))
CommunityChestCards%>% select(-index) %>% mutate(#assign player who drew it, then assign that value to street repair
  Money = c(200, 200, -50, 50, NA, NA, 100, 20, 10*(nrow(player_stats)-1), 100, -100, -50, 25,-40*(player_stats[[player_turn,"Houses"]])-115*(player_stats[[player_turn,"Hotels"]]), 10, 100),
  Location = c(NA, 1, NA, NA, NA, 31, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), 'Drew By' = NA_character_) ->> CommunityChestCards
}

reset_CommunityChestCards()
CommunityChestCards

move_player <- function(x) {
  roll()#rolls dice to determine spaces to move
  print(total_sum)#prints dice roll result
  new_location <- player_stats[[x, "Location"]] + total_sum#moves the player to the new location
  
  if (new_location > 40) {#checks if the player passes 40th square
    new_location <- new_location - 40#removes 40 from total position corresponding to lapping the board
    player_stats[x, "Money"]<<-  player_stats[x, "Money"]+ 200#adds 200 dollars to that player_stats money
    bank$Money<<- bank$Money-200 #takes away the money from the bank
    passed_Go <- c("Player: ", player_stats$Name[x], "passed Go")
    print( passed_Go)#announces player passed go
  }
  
  if(total_sum == 0 || new_location == 31){#conditions for going to jail
    
    new_location <- 11}#sends player to jail
  
  player_stats[x, "Location"] <<- new_location#moves player to the correct space after go
  new_location<<-new_location
  
 return(player_stats)#displays the new player_stats stat
  return(new_location)
  
  }





#completed function for drawing cards
Draw_Community_Card <- function() {
  if (nrow(CommunityChestCards) < 1) {#what to do when last card is drawn
    return(c("out of cards"))
  }
  community_card_drew <- sample(1:nrow(CommunityChestCards), 1)#pick 1 card from the available number of cards(rows)
  community_card <- CommunityChestCards[community_card_drew, ]#define which card was drawn as community_card
  community_card[1,'Drew By']<-player_turn#update the 'Drew By' element of that card to log who drew it
  
  #logs which card was removed
  removed_community_cards <<- rbind(removed_community_cards, community_card)#add that card to the global list of drawn community cards
  
  CommunityChestCards <<- CommunityChestCards[-community_card_drew, ]#remove the card from the available community cards globally 
  return(community_card)#display the drawn card 
}


player_stats
player_turn<-player_stats[[1,1]]#defines current player turn as the numeric value associated with the "player_stats" tibble first row and column
player_turn

player_stats[[player_turn,"Houses"]]#from the player_stats tibble, reads off the number associated with player_turn as the row, and counts how many houses they own
player_stats[[player_turn,"Hotels"]]

```

```{r}
#testing grounds to make sure everything still works
testing <- function(n){#test the roll function to make sure values come out correctly
# Set the number of iterations
  n_iterations <- n

# Create a vector to store the logged values
total_sum_vector <- numeric(n_iterations)

# Loop through the iterations
for (i in 1:n_iterations) {
  #literally copied this from the internet but it works flawlessly
sink(nullfile())
  roll()
  sink()
  # Run the roll() function and store the result in the vector
  total_sum_vector[i] <- total_sum
}
return(total_sum_vector)

}

#graphical representation of 100000 roll results
hist(testing(100000), breaks = 50)#should display a histogram of the dice rolls, a roll of 1-2 should be impossible, 0 denotes rolling triple doubles, anything over 11 denotes rolling a double, there should be a lot kore 3-11 rolls than anything else.

#game test
#need to fix this
run_move_player <- function() {
  i <- 1
  k <- 1
  location_tally <- c()
  while (TRUE) {
    move_player(i)
    location_tally[k] <- new_location
    k <- k + 1
    if (bank$Money < -10000) {
      print("Bank has run out of money!")
      break
    }
    i <- i + 1
    if (i > 4) {
      i <- 1
    }
  }
  return(list(player_stats = player_stats, location_tally = location_tally))
}


run_move_player()

#function testing that drawing works
test_communitycards <- function() {
  output_list <- list()
  reset_CommunityChestCards()
  for (i in 1:17) {
    Draw_Community_Card <- function() {
      if (nrow(CommunityChestCards) < 1) {
        return(c("out of cards"))
      }
      community_card_drew <- sample(1:nrow(CommunityChestCards), 1)
      community_card <- CommunityChestCards[community_card_drew, ]
      CommunityChestCards <<- CommunityChestCards[-community_card_drew, ]
      return(community_card)
    }
    output_list[[i]] <- Draw_Community_Card()  # Move this line inside the loop
  }
  print(output_list)
}

test_communitycards()#should display each of the 16 community chest cards as a tibble in a list, in random order, then it should display a character vector c("out of cards") as teh 17th entry


Draw_Community_Card <- function() {
  if (nrow(CommunityChestCards) < 1) {
    return(c("out of cards"))
  }
  community_card_drew <- sample(1:nrow(CommunityChestCards), 1)
  community_card <- CommunityChestCards[community_card_drew, ]
  community_card[1,'Drew By']<-player_turn
  
  #logs which card was removed
  removed_community_cards <<- rbind(removed_community_cards, community_card)
  
  CommunityChestCards <<- CommunityChestCards[-community_card_drew, ]
  return(community_card)
}




move_player<-function(){
player<-function(){#manually set player turn for now
  x <- player_turn
  if(player_turn > nrow(player_stats)){player_turn <<-1
  total_turns<<-total_turns + 1}
  player_turn<<-player_turn+1
  return(player_turn-1)
  }
move<- function(x){
  roll()#rolls dice to determine spaces to move
  print(total_sum)#prints dice roll result
  new_location <- player_stats[[x, "Location"]] + total_sum#moves the player to the new location
  
  if (new_location > 40) {#checks if the player passes 40th square
    new_location <- new_location - 40#removes 40 from total position corresponding to lapping the board
    player_stats[x, "Money"]<<-  player_stats[x, "Money"]+ 200#adds 200 dollars to that player_stats money
    bank$Money<<- bank$Money-200 #takes away the money from the bank
    passed_Go <- c("Player: ", player_stats$Name[x], "passed Go")
    print( passed_Go)#announces player passed go
  }
  
  if(total_sum == 0 || new_location == 31){#conditions for going to jail
    
    new_location <- 11}#sends player to jail
  
  player_stats[x, "Location"] <<- new_location#moves player to the correct space after go
  new_location<<-new_location
  
 return(player_stats)#displays the new player_stats stat
  return(new_location)}
player()%>%move()
return(player_stats)
if(new_location == 3||18||34){Draw_Community_Card()}#doesnt work, just ignores it
}


```


## Section Four

```{r student4}

```
